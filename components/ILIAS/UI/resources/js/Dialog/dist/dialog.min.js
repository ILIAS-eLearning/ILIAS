/**
 * This file is part of ILIAS, a powerful learning management system
 * published by ILIAS open source e-Learning e.V.
 *
 * ILIAS is licensed with the GPL-3.0,
 * see https://www.gnu.org/licenses/gpl-3.0.en.html
 * You should have received a copy of said license along with the
 * source code, too.
 *
 * If this is not the case or you just want to try ILIAS, you'll find
 * us at:
 * https://www.ilias.de
 * https://github.com/ILIAS-eLearning
 */
!function(e,t){"use strict";function i(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=i(e),o=i(t);class r{#e;#t;#i;constructor(e,t){if(this.#e=e,this.#t=document.getElementById(t),null===this.#t)throw new Error(`Could not find a Dialog for id '${t}'.`);this.#i=this.#t.getElementsByTagName("dialog").item(0)}show(e){this.load(e),this.#i.showModal()}close(){this.#i.close()}async load(e,t={}){await fetch(e,t).then((e=>e.text())).then((e=>{const t=(new this.#e).parseFromString(e,"text/html"),i=t.querySelector('section[data-section="il-dialog-response__title"]'),n=t.querySelector('section[data-section="il-dialog-response__contents"]'),o=t.querySelector('section[data-section="il-dialog-response__buttons"]'),r=t.querySelector('section[data-section="il-dialog-response__command"]'),s=t.querySelector('section[data-section="il-dialog-response__parameters"]'),a=t.querySelector("script"),l=this.#i.querySelector("span.il-dialog__title"),c=this.#i.querySelector("div.il-dialog__contents"),d=this.#i.querySelector("div.il-dialog__buttons");l.innerHTML=i.innerHTML,c.innerHTML=n.innerHTML,d.innerHTML=o.innerHTML,this.#n(c),this.#o(c),a&&this.#r(a.text);const h=[];return s.querySelectorAll("data").forEach((e=>{h[e.innerHTML.trim()]=e.getAttribute("value")})),{cmd:r.innerHTML.trim(),params:h}})).then((e=>{const t=e.cmd,{params:i}=e;"close"===t&&this.close(),"redirect"===t&&window.location.replace(i.redirect)}))}#r(e){const t=this.#t.querySelector("section.il-dialog__scripts"),i=document.createElement("script");i.text=e,t.innerHTML="",t.appendChild(i)}#n(e){e.getElementsByTagName("form").forEach((e=>{e.addEventListener("submit",(t=>{t.preventDefault(),this.load(e.action,{method:e.method,body:new FormData(e)})}))}))}#o(e){e.getElementsByTagName("a").forEach((e=>{if("_blank"!==e.target){const t=e.href;e.addEventListener("click",(()=>this.load(t))),e.removeAttribute("href")}}))}}n.default.UI=n.default.UI||{},n.default.UI.dialog=new class{#e;#s=[];constructor(e){this.#e=e}init(e){if(void 0!==this.#s[e])throw new Error(`Dialog with id '${e}' has already been initialized.`);this.#s[e]=new r(this.#e,e)}get(e){return this.#s[e]??null}}(o.default)}(il,DOMParser);
