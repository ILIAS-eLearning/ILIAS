////
/// # ILIAS UI: Forms & Input fields
/// General layout & design shared by all UI Framework forms and input fields.
/// Forms can repeatedly nest elements. You SHOULD use children selectors (>) to target very specific structures.
////

/// ## Imports
/// ### Modules included in SASS
/// for managing lists with allowed layout locations
@use 'sass:list';

/// ### ILIAS modules
@use "../../../010-settings" as *;
@use "../../../010-settings/legacy-settings/legacy-settings_form" as *;

@use "../../../030-tools/tool_focus-outline" as *;
@use "../../../030-tools/tool_rem-conversion" as *;
@use "../../../030-tools/_tool_browser-prefixes" as *;

@use "../../../050-layout/basics" as *;
@use "../../../050-layout/layout_form" as l-form;
@use "../../../050-layout/layout_breakpoints" as brk;
@use "../../../050-layout/basics" as l;

//== Specific Inputs
//
//
@use "_ui-component_tag.scss";
@use "_ui-component_password.scss";
@use "_ui-component_radio.scss";
@use "_ui-component_multiselect.scss";
@use "_ui-component_textarea.scss";
@use "_ui-component_filter.scss";
@use "_ui-component_duration.scss";
@use "_ui-component_file.scss";
@use "_ui-component_markdown.scss";
@use "_ui-component_rating.scss";
@use "_ui-component_numeric.scss";
@use "_ui-component_switchablegroup.scss";
@use "_ui-component_optionalgroups.scss";

//== Standard Form
//
//## Variables used to style the ILIAS standard form used e.g. in the "Settings"-Tab

.il-standard-form{
  background-color: $il-standard-form-bg;
  margin-top: $il-margin-large-vertical;
  padding: $il-standard-form-header-padding;

  .il-standard-form-cmd {
    float: right;
    .btn {
      display: inline-block;
      min-width: $il-button-min-width-forms;
      vertical-align: top;

      @media (max-width: $il-grid-float-breakpoint-max){
        min-width: 0;
      }

/// ### All input UI components
/// This file is an entry point for all input fields of the UI framework.
/// CSS generation only. You MUST NOT use any of their variables, functions, mixins outside local scope.
@use "ui-component_tag";
@use "ui-component_checkbox";
@use "ui-component_password";
@use "ui-component_radio";
@use "ui-component_multiselect";
@use "ui-component_textarea";
@use "ui-component_filter";
@use "ui-component_duration";
@use "ui-component_file";
@use "ui-component_link";
@use "ui-component_markdown";
@use "ui-component_rating";
@use "ui-component_section";
@use "ui-component_optionalgroups";

/// general form container styling
.c-form {
  .c-form__header,
  .c-form__footer {
    display: grid;
    grid-template-areas: "required actions";
    grid-template-columns: 1fr auto;

    .c-form__actions {
      grid-area: actions;
    }

    .c-form__required {
      grid-area: required;
    }
  }
  .c-form__footer {
    margin-top: l.$il-margin-xxlarge-vertical;
  }
}

/// standard grid layout
.c-input[data-il-ui-type] {
  display: grid;
  grid-template-columns: l-form.$form__label-column__width l-form.$form__field-column__width;
  grid-template-areas:  "label field"
                        "label error"
                        "label help";

  margin-top: l.$il-margin-xxlarge-vertical;
  &:first-child {
    margin-top: 0;
  }

  > label {
    display: block;
    grid-area: label;
    padding-right: l.$il-margin-large-horizontal;
  }

  > .c-input__field {
    grid-area: field;
  }

  > .c-input__help-byline {
    grid-area: help;
  }

  > .c-input__error-msg {
    grid-area: error;
  }

  @include brk.on-screen-size(small) {
    grid-template-columns: 100%;
    grid-template-areas:  "label"
                          "field"
                          "error"
                          "help";
    > .c-input__field {
      margin-top: l.$il-margin-base-vertical;
    }
  }
}

/// styling shared by multiple input elements

// hover/focus extends beyond box without pushing it
.c-input:not([data-il-ui-type="SectionFieldInput"]) {
  &:hover {
    box-shadow: 0px 0px 0px l.$il-margin-base-horizontal $il-main-dark-bg;
    background-color: $il-main-dark-bg;
  }
  &:has(:focus-visible) {
    box-shadow: 0px 0px 0px l.$il-margin-base-horizontal $il-highlight-bg;
    background-color: $il-highlight-bg;
  }
}

.c-form {
  .c-form__error-msg {
    margin-top: l.$il-margin-large-vertical;
    margin-bottom: 0; // overrides alert default
  }
  .c-input[data-il-ui-type] input:invalid {
    background-color: $il-alert-danger-bg;
    border: 1px solid $il-alert-danger-border;
  }
  .c-input__help-byline {
    margin-top: l.$il-margin-small-vertical;
    font-size: $il-font-size-small;
  }
  .c-input__error-msg {
    margin-top: l.$il-margin-small-vertical;
    &:first-child {
      margin-top: 0;
    }
    margin-bottom: 0; // overrides alert default
  }
  .c-input[data-il-ui-type]:not([data-il-ui-type="SectionFieldInput"]):has(> .c-input__error-msg) {
    border-inline-start: 6px solid $il-alert-danger-border;
    padding-left: l.$il-padding-base-horizontal;
  }
  [data-il-ui-type="TextareaFieldInput"] .c-input__field textarea,
  [data-il-ui-type="MarkdownFieldInput"] .c-input__field .c-field-markdown textarea {
		height: l-form.$il-textarea-height;
		max-width: 100%; // otherwise textarea size can be dragged beyond mainspacekeeper in many browers
  }
  [data-il-ui-type="TextFieldInput"] .c-input__field input,
  [data-il-ui-type="PasswordFieldInput"] .c-input__field .c-field-password input,
  [data-il-ui-type="TextareaFieldInput"] .c-input__field textarea,
  [data-il-ui-type="MarkdownFieldInput"] > .c-input__field .c-field-markdown textarea,
  [data-il-ui-type="UrlFieldInput"] .c-input__field input {
    width: 100%;
    padding: l.$il-padding-base-vertical l.$il-padding-base-horizontal;
    font-size: $il-standard-form-font-size;
  }
  [data-il-ui-type="DateTimeFieldInput"] .c-input__field input,
  [data-il-ui-type="NumericFieldInput"] .c-input__field input {
    padding: l.$il-padding-base-vertical l.$il-padding-base-horizontal;
    font-size: $il-standard-form-font-size;
  }
  [data-il-ui-type="SelectFieldInput"] .c-input__field select {
    padding: l.$il-padding-base-vertical l.$il-padding-base-horizontal;
  }
}
