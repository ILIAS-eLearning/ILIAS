<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"" xml:lang="en" lang="en">
<head>
        <title>ILIAS 3 Manual</title>
        <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1" />
        <link rel="stylesheet" type="text/css" href="./default.css" />
</head>
<body>
<h1>Contents</h1>
<a href="#00"><h2>Role Based Access Control (RBAC) in ILIAS3</h2></a>
<ul>
<li><a href="#01">What is RBAC?</a></li>
<li><a href="#02">Basic Concept</a></li>
<li><a href="#03">Object Hierarchy</a></li>
<li><a href="#04">Role Permission Templates</a></li>
<li><a href="#05">System Roles</a></li>
<li><a href="#06">Local Roles</a></li>
<li><a href="#role_templates">Role Templates</a></li>
<li><a href="#07">Permission Inheritance</a></li>
</ul>
<a href="#08"><h2>Working with RBAC & using the Administration Console</h2></a>
<ul>
<li><a href="#09">General Administration</a></li>
<ul>
<li><a href="#10">Basic Settings</a></li>
<li><a href="#11">Language Management</a></li>
<li><a href="#12">Mail settings</a></li>
<li><a href="#13">Objects & Type Definition settings</a></li>
<li><a href="#14">Role Managment</a></li>
<ul>
<li><a href="#14b">Permission types</a></li>
</ul>
<li><a href="#15">User Management</a></li>
</ul>
<li><a href="#16">Object Management</a></li>
<li><a href="#scenario1">Example scenario</a></li>
</ul>
<a href="#17"><h2>Information for developers</h2></a>
<ul>
<li><a href="#18">class structure</a></li>
<li><a href="#19">database model</a></li>
<li><a href="#add_modules">Adding new modules to ILIAS3</a></li>
<ul>
<li><a href="#add_object_type">Defining & adding a new object type</a></li>
<li><a href="#add_operations">Defining & adding new operations</a></li>
<li><a href="#setup_classes">Setting up the basic object classes</a></li>
</ul>
<li><a href="#objects_xml">Object type definition concept</a></li>
<ul>
<li><a href="#objects_xml_doc">objects.xml documentation</a></li>
</ul>
<li><a href="#sessions">Active Roles & Sessions</a></li>
<li><a href="#identifier">Unique Identifer</a></li>
<ul>
<li><a href="#identifier_types">for object types</a></li>
<li><a href="#identifier_objects">for object instances</a></li>
</ul>
<li><a href="#objects">Object concept</a></li>
<li><a href="#objects">Object type documentation</a></li>
<ul>
<li><a name="#root">Root Folder object</a></li>
<li><a name="#adm">System Folder object</a></li>
<li><a name="#lngf">Language Folder object</a></li>
<li><a name="#lng">Language object</a></li>
<li><a name="#mail">Mail settings object</a></li>
<li><a href="#rolf">Role Folder object</a></li>
<li><a name="#role">Role object</a></li>
<li><a name="#rolt">Role Template object</a></li>
<li><a name="#usrf">User Folder object</a></li>
<li><a name="#usr">User object</a></li>
<li><a name="#objf">Object Folder object</a></li>
<li><a name="#typ">Object Type object</a></li>
<li><a name="#cat">Category object</a></li>
<li><a name="#grp">Group object</a></li>
<li><a name="#frm">Forum object</a></li>
<li><a name="#file">File object</a></li>
<li><a name="#crs">Course object</a></li>
<li><a name="#lm">LearningModule object</a></li>
<li><a name="#slm">SCORM LearningModule object</a></li>
</ul>
<li><a href="#templates">HTML Templates</a></li>
<li><a name="#errorhandling">Error handling</a></li>
<li><a name="#feedback">System feedback</a></li>
<ul>
<li><a name="#sendmessage">sendMessage()</a></li>
<li><a name="#infopanel">Infopanel</a></li>
</ul>
<li><a name="#db_updates">Database updates & migration</a></li>
</ul>
<a href="#appendix"><h2>Appendix</h2></a>
<ul>
<li><a name="#glossary">Glossary</a></li>
<li><a href="#links">Resources</a></li>
<li><a name="#apidoc">API Documentation</a></li>
<ul>
<li><a name="#peardoc">Used PEAR classes</a></li>
<li><a name="#phpdoc">PHPdoc</a></li>
</ul>
</ul>


<a name="00">&nbsp;<br/><h2>Role Based Access Control (RBAC) in ILIAS3</h2></a>


<a name="01">&nbsp;<br/><h2>What is RBAC?</h2></a>
<p>Role Based Access Control (RBAC) has been developed by the <a href="http://hissa.nist.gov/project/rbac.html">National Institute Of Standards And Technology (NIST)</a>. It is based on the idea that a specific user does not have any permission to access any object directly, but he/she is assigned to a role. These roles contain exactly defined permissions to protect objects and data against unauthorized access. A specific user may be assigned to one or more roles (see Figure 1)</p>
<br/>
<p><img src="./images/rbac_model.gif" /><br/>Figure 1: RBAC reference model</p>
<ul>
<li><b>Objects (Obj):</b> An object can be any ILIAS3 system resource subject to access control, such as a category, forum, file, group, user, role</li><br/>
<li><b>Operations (Ops):</b> An operation defines a single action that may be performed with an object.  Each object type may have a different set of allowed operations (i.e. the 'join' operation only applies for a group, course and learningmodule object)</li><br/>
<li><b>Permissions:</b> A Permission is an approval to perform an operation on one or more RBAC protected objects. In other words permissions are sets of relations for each object and the possible operations on it. Roles are linked with a list of these permissions and a list of users.</li><br/>
<li><b>Role:</b> A Role reflects a job function within the context of an organization with some associated semantics regarding the authority and responsibility conferred on the user assigned to the role. Technically a role is a collection of users and permissions.</li><br/>
<li><b>User:</b> A user is defined as a person with a valid account within an ILIAS installation.</li><br/>
</ul>


<a name="02">&nbsp;<br/><h2>Basic Concept</h2></a>
<p>The implemented RBAC system in ILIAS3 follows the proposed recommendations for an RBAC reference model, level 1 ('Core RBAC') by <a href="http://www.nist.gov">NIST</a>. Core RBAC defines a minimum collection of RBAC elements, element sets, and relations in order to completely achieve a Role-Based Access Control system. This includes user-role assignment and permission-role assignment relations, considered fundamental in any RBAC system.</p>
<p>In addition, Core RBAC introduces the concept of role activation as part of a user's session within a computer system which is partly implemented in ILIAS3 (see <a href="#active_roles">Active Roles</a>).</p>


<a name="03">&nbsp;<h3>The Object hierarchy</h3></a>
<p>All resources in ILIAS3 are treated as <a href="#glossary_objects">objects</a> and are organized in a tree structure (see <a href="#objects">object concept</a>) which allows in conjunction with RBAC the concept of <a href="#06">Local Roles</a> (Roles with limited scope), <a href="#04">Role Permission Templates</a> and the <a href="07">inheritance of object permissions</a>. These features greatly simplify the administrative tasks of the system. In addition, the tree structure is crucial to RBAC by handling the problem of newly created objects (see <a href="#07">Permission inheritance</a>).</p>


<a name="03">&nbsp;<h3>RBAC protected Objects</h3></a>
<p>All RBAC protected objects are stored in the tree structure. The term 'RBAC protected objects' refers to all objects which have its own permission set stored in the database. Some <a href="#object_types">object types</a> like <span class="typ">user</span> or <span class="typ">role</span> don't have a permission setting because it is not necessary to distinguish within RBAC among them. But to provide any access control to these object types, they are latched into specific container objects (<i>Role folder</i> respectively <i>User folder</i>) which are subject to access control by the RBAC system.</p>


<a name="04">&nbsp;<h3>Role Permission Templates</h3></a>
<p>For every object exists a set of permissions linked to a role. Each role has its own set of permissions for every individual object! What happens if you create a new object is that you are required to set the permissions of the object for every existing role in the system which is first an intolerable administrative effort for the user and second a possible security hole.</p>
<p>Therefore ILIAS3 offers you the possibility to set a so called <b>Permission Template</b> for each role. That means you can create default permissions for every object type. If a specific object is created, the permissions are set accordingly to these template permissions.</p>
<p>Furthermore it is possible to accommodate the permissions of all existing objects after changing the role template (see option description '<a href="#change_existing_objects">Change existing Objects</a>'). You can also <a href="#userassignment">assign/deassign users to roles</a>.</p>


<a name="05">&nbsp;<h3>System Roles</h3></a>
<p>As stated above, roles are linked into the <a href="#03">Object hierarchy</a> by latching them in a specific <a href="#object_types_rolf">Role folder</a>. The so called System Roles (Administrator, Author and Learner) are roles, which are stored in the main Role Folder right beneath the System Settings Folder. This is the top most Role Folder object and the roles within it do have a 'global' influence on all objects in ILIAS3. If a new object is created anywhere in the hierarchy, it 'inherits' its permissions from these System Roles.</p>


<a name="06">&nbsp;<h3>Local Roles</h3></a>
<p>Every RBAC protected object can possess its own role folder where you may add new roles (and assign users to them). Roles in other role folders except the main Role folder in the system settings are called 'local roles' because they only have a local scope. Their influence ranges from the location in the object hierarchy downwards the tree structure including the parent object where the Role folder is assigned to.</p>
<p>We distinquish two types of local roles:
<ul>
<li><b>'Real' local roles</b> are created manually in a local Role folder by the user. You may assign users to these local roles.</li>
<li><b>'Linked' local roles</b> are created by the RBAC system when the <a href="#07">inheritance of permissions</a> was interrupted. It is not possible to assign users to these local roles.</li>
</ul>
</p>
<a name="role_templates">&nbsp;<h3>Role Templates</h3></a>
<p>Role Templates are like common roles but you cannot assign users to them. The purpose of Role Templates is to store individual permission presets you want to use later on particular objects only.
Whenever you create a new Local Role you are prompted to set its permission rules. Instead of applying all permission settings manually every time a new Local Role is created, you may just adopt your settings from a Role Template.</p>
<p>Normally when you setup your access control strucure for the first time by modelling the proper Roles and Local Roles you aim for a role model that automate the permission settings for most cases to keep administrative maintainance low.
But in some special cases you want to change the permission settings for an individual branch of your object hierarchy that cannot be covered by pre-defined permission rules (i.e. Consider an unpredictable minor change in your organizational structure or in the responsibility of a small subset of users.)
In such cases Role Templates can be useful to accommodate the changes with 'one click'.</p>
<p>In the Adminstration console Role Templates are distinquished from common roles by the color of their icons. Icons for Role Templates are greyed.</p>


<a name="07">&nbsp;<h3>Permission Inheritance</h3></a>
<p>When ever a user creates a new object its permission settings is inherited from all role permission templates found in any Role folder 'above', starting from the position where the new object is inserted into the object hierarchy. The RBAC system 'looks up' the tree structure and creates for each role found on the path a permission set for the new object. At this point the benefits of the object hierarchy become apparent: The user who created the object doesn't need to worry about any permission settings as this is done automatically by the system.</p>


<a name="stopping_inheritance"><p><b>Stopping Permission Inheritance</b></p></a>
<p>You may interrupt this inheritance mechanism for every object and role separately. This is useful when you want to alter the permission setting rules for new objects of an existing role only at a specific position in the object hierarchy. What happens is that under the object a new local role folder is created (only if there is not already one existing) and a local role with the same name is created.</p>
<p>This local role is 'linked' with that role from which the inheritance was stopped. You may then alter the permission settings of the linked local role. It is theoretically possible to stop the inheritance of a specific role arbitrarily often. The local scope of each linked local role reaches down the tree structure until another linked local role from the same 'master' role is found. Remember that these rule for the scope of local roles also apply to the option <a href="#change_existing_objects">Change existing objects</a>. Only the objects in the scope are accommodated!</p>


<a name="08">&nbsp;<br/><h2>Working with RBAC & using the Administration Console</h2></a>
<p>All configurations in ILIAS3 are done in the administration console. Here you can manage all objects and administrate the general settings of your system. To get to the administration console, log into the system with an Administrator account and click in the main menu on the button with the monkey wrench.</p>
<p><img src="./images/mainbuttons1.png" /><br/>Figure 2: Where to enter the administration console</p>
<p>The administration console uses two frames. A navigation frame to the left shows all available system resources. The big content frame on the right shows different information of a system resource you have currently selected.</p>
<p><a href="./images/admin1.png" target="enlarge"><img src="./images/admin1_t.jpg" /><br/>Screenshot: Interface components of the administration console</a></p>

<h3>The navigation frame</h3>
<p>This explorer-like interface represents your current system resources in their hierarchical order. All available objects are shown with their title and a small icon which tells you the type of each object. When an object contains other objects a small plus icon is displayed next to that object. By clicking on it you can expand the view to show the containing objects in the explorer frame. When you click on the object title its content is shown in the content frame to the right.
<br/>With the refresh button right under the explorer tree you can reload the view after altering your system resources (i.e. added/moved or deleted objects in the hierarchy).</p>

<h3>The content frame</h3>
<p>Each panel you are viewing in the content frame is composed of several interface elements:</p>
<ul>
<br/><li><b>Admin tabs:</b> At the top of  the content frame you see different tabs where you may view and edit the different properties of the current object shown. Depending of the object type you are viewing the offered admin tabs may differ but almost all object types have a 'View Content', 'Edit Properties', 'Permissions' and 'Show Owner' tab.
<br/><br/>Common tabs and their function:<br/></li>
<ul>
<br/><li>'View Content' - Shows you a list of all other objects the current object contains. This is the default view when you click on an object.</li>
<br/><li>'Edit Properties' - Let you edit the title and description of the current object. Depending on the object type other options that you may edit are displayed.</li>
<br/><li>'Permissions' - Displays you a table where all applicable roles and their possible operations on the current object are listed. You may set/unset each permission for each role for the current object.</li>
<br/><li>'Show Owner' - Displays the owner of the current object. The owner is the user who created the current object.</li>
<br/></ul>
<br/><li><b>Object title:</b> Right under the admin tabs is the title of the current object displayed.</li>
<br/><li><b>Locator:</b> The locator tells you where you are in the object hierarchy by displaying the path from the top node ('ILIAS open source') to the object you are currently viewing. You may click on each object title shown in the path to navigate directly to that object.</li>
<br/><li><b>Content table:</b> Displays basic information about all containing objects of your current object.</li>
<br/><li><b>Action buttons:</b> Displays several actions you may perform with any of the objects listed in the content table. Note that if an object listed has no checkbox you can't do any of the offered actions with it. This applies for system related object types like the system settings folder itself.</li>
</ul>


<a name="09">&nbsp;<br/><h2>General Administration</h2></a>
<p>Enter the 'system settings' by clicking the name either in the navigation frame or in the content frame. You see several sub objects and a list of basic settings.</p>
<p><a href="./images/admin2.gif" target="enlarge"><img src="./images/admin2_t.jpg" /><br/>Screenshot: The main System Settings folder</a></p>


<a name="10">&nbsp;<br/><h2>Basic settings</h2></a>
<p>todo</p>


<a name="11">&nbsp;<br/><h2>Language Management</h2></a>
<p>
In this panel all language administration is done. ILIAS3 is capable of supporting multiple languages.</p>
<p><a href="./images/admin_lang1.gif" target="enlarge"><img src="./images/admin_lang1_t.jpg" /><br/>Screenshot: Language administration panel</a></p>
<ul>
<li><b>Refresh languages:</b> This option updates all installed languages. The language data is deleted from database and the will be re-read again from the language file.</li><br/>
<li><b>Check languages:</b> Checks all languages file for validity. This option is only interesting if you want to modify your language data or add your own translation.
<br/>Further information about the language concept being used in ILIAS, instructions on how to add your own translation and details about the data format can be found in the <a href="http://www.homer.ilias.uni-koeln.de/iliasdoc/doc/html/1.html">online manual</a>, chapter <a href="http://www.homer.ilias.uni-koeln.de/iliasdoc/doc/html/8_4.html">Language concept</a>.</li><br/>
<li><b>Install language:</b> Installs a language and makes it available for all users to choose from.</li><br/>
<li><b>Uninstall language:</b> Uninstalls a language.</li><br/>
<li><b>Set system language:</b> Set the default language for unregistered users.</li><br/>
<li><b>Set user language:</b> Set the language for the current account (you). This option does the same like the language selection in your personal profile.</li>
</ul>


<a name="12">&nbsp;<br/><h2>Mail settings</h2></a>
<p>Click on the permission tab and specify which roles should grant the users normal Email usage or sending of internal system messages.</p>
<ul>
<li><b>Allow Email:</b> check the box for the operation <span class="ops">smtp mail</span> for the appropriate role</li><br/>
<li><b>Allow system message:</b> Check the box for the operation <span class="ops">system message</span> for the appropriate role</li><br/>
</ul>
<p>todo: some mail settings are missing</p>


<a name="13">&nbsp;<br/><h2>Object and Type definition settings</h2></a>
<p>This panel offers options only for developers. You don't need to change here anything.
The purpose of this panel is to change the assignment of operations to each object type. Click on an object in the list and choose the tab 'Edit Operations'. Here you may enable and disable the possible operations for the current object.</p>


<a name="14">&nbsp;<br/><h2>Role Managment</h2></a>
<p>The Role Management panel is where the primary permission setting is done. Here you define the access rules for each role and assign users to them.
When you enter the Role Management you see a list of already existing roles and role templates, each with its name and a short description. Roles have a blue icon, those for role templates are grey. The only difference between a role and a role template is that you cannot assign users to a role template.</p>
<p><a href="./images/admin_roles1.gif" target="enlarge"><img src="./images/admin_roles1_t.jpg" /><br/>Screenshot: Overview of existing Roles and Role Templates</a></p>
<ul>
<li><b>Add new Role/Role Template:</b> At the bottom right of the list with the existing roles you see a drop down select box. Choose 'Role' or 'Role Template' and click 'add'. Next you see the 'edit properties' panel where you have to give the new role a name. Note that each role must have a unique name.</li><br/>
<li><b>Delete a Role/Role Template:</b> To delete a role or a role template mark the checkbox next to that role/role template and click the 'delete' button. You cannot delete a role if there are still users assigned to it.</li><br/>
<li><b>Edit access rules:</b> In the list click on the icon next to the role's name and you are taken to the permission settings panel. You see a table with a matrix showing the possible permission settings for each object type. Each column represents one object type identified by its internal abbreviation (see <a href="#identifier_types">Unique identifier</a>). The rows list the permissions with a checkbox for each object type in case the particular permission is applicable for that type (see permission types).
<p><a href="./images/admin_roles2.gif" target="enlarge"><img src="./images/admin_roles2_t.jpg" /><br/>Screenshot: The Role Permission Template matrix</a></p></li><br/>
<li><b><a name="change_existing_objects">Change existing objects:</a></b> Beside the main purpose of a role to manage access control for the assigned users, a role acts like a pre-defined <a href="#04">Permission Template</a> for newly created objects. If a specific object is created, the permissions are set accordingly to these template permissions. But if you change the permission settings of an existing role you may want to accommodate your changes to all objects that were already existent in your system. To do so check the option 'change existing objects' in last row of the table. All objects within the scope of that role (see chapter x.x permission inheritance) will be adjusted by the changes you have made.</li><br/>
<li><b><a name="adopt_permissions">Adopt permission settings</a> from another role or a role template:</b> You may adopt the permission settings of a role/role template to another one. This option may be useful when you want to define a role whose settings differs only slighty from another role.  Instead of set each single permission setting manually just choose a role from the list below permission matrix and click 'adopt'. After filling your new role with the adopted 'pre-settings' you can apply your changes. In this way you can reduce your administrative effort reasonably.</li><br/>
<li><b><a name="userassignment">Assign/deassign a User:</a></b> Click on the tab 'Userassignment' (todo: this option is still located in 'permission' tab) to review the users currently assigned to the role and to assign/deassign users. Just select or unselect the checkbox next to a user's name to assign or deassign him. Note that you cannot deassign a user if the role would be the only one currently assigned to him.
<p><a href="./images/admin_roles3.gif" target="enlarge"><img src="./images/admin_roles3_t.jpg" /><br/>Screenshot: Panel for adopting role permission settings and user-role assignment</a></p></li>
</ul>


<a name="14b">&nbsp;<br/><h3>Permission types</h3></a>
<p>There are 12 different permissions in ILIAS3. In the following table is a description how each permission behaves when a user performs an operation on a RBAC protected object.</p>

<table border="1">
<tr>
<th>Permission</th>
<th>description</th>
</tr>
<tr>
<td><span class="ops">Create</span></td>
<td>User can create an object of that type. This permission is checked when the users tries to add a new object of that type.
</td>
</tr>
<tr>
<td><span class="ops">Delete</span></td>
<td>User can delete an object of that type. This permission is checked when the users tries to delete any object.</td>
</tr>
<tr>
<td><span class="ops">Delete Post</span></td>
<td>User can delete a post in a forum. This permission is checked when the users tries to delete a post in a forum. Toggles the display of 'delete' in the option list shown at the bottom of each post. This permission only applies to the forum object.</td>
</tr>
<tr>
<td><span class="ops">Edit Permission</span></td>
<td>User can modify the permission settings of an object of that type. This permission is checked when the users tries to access the permission settings panel.</td>
</tr>
<tr>
<td><span class="ops">Edit Post</span></td>
<td>User can edit a post in a forum. This permission is checked when the users tries to edit a post in a forum. Toggles the display of 'edit' in the option list shown at the bottom of each post. This permission only applies to the forum object. Note that a post can always be edited by its author.</td>
</tr>
<tr>
<td><span class="ops">Join</span></td>
<td>User can autonomous join a group respectively subscribe to a course or learning module. This correspond to the concept of open groups in ILIAS2.x where a user can freely subscribe to a group. If this permission is not granted to the user he only may join a group by being invited of a group member, and according to learning modules and course the user has to be subscribed manually by another user.</td>
</tr>
<tr>
<td><span class="ops">Leave</span></td>
<td>User can autonomous leave a group respectively unsubscribe from a course or learning module. This permission is not used yet. Its purpose was the intention that a user may not leave a group/course on its own but needs to consult the responsible tutor/teacher for that resource.</td>
</tr>
<tr>
<td><span class="ops">Read</span></td>
<td>User can read an object of that type. This permission is checked when the users tries to access any object. This is the most common permission since it is checked every time an object is being accessed by a user.</td>
</tr>
<tr>
<td><span class="ops">Smtp mail</span></td>
<td>User can send normal Email with the Mailsystem. Toggles the display of the option 'send email' in the mail module when the user composes a new internal mail.</td>
</tr>
<tr>
<td><span class="ops">System message</span></td>
<td>User can send internal mails with status 'System message'. Toggles the display of the option 'system messagel' in the mail module when the user composes a new internal mail. A System message is only displayed on the recipient's personal desktop and won't be saved to his message inbox.</td>
</tr>
<tr>
<td><span class="ops">Visible</span></td>
<td>User can see an object of that type. This permission is checked whenever the users access a page where objects are displayed.</td>
</tr>
<tr>
<td><span class="ops">Write</span></td>
<td>User can edit an object of that type. This permission is checked when the users tries to modify any object.</td>
</tr>
</table>

<p>If you want to develop new modules for ILIAS3 you might come into the situation that you want to check a specific permission
in your application but none of the existing operations seem to suit your special case.
Then you need to add new operations to the RBAC system what can be easily done. How to <a href="#add_operations">add new operations</a> and further details for developers are described in the section <a href="#17">Information for developers</a></p>


<a name="15">&nbsp;<br/><h2>User Management</h2></a>
<p>Here you can add, delete and review all user accounts.</p>
<p><a href="./images/admin_users1.gif" target="enlarge"><img src="./images/admin_users1_t.jpg" /><br/>Screenshot: The user administration panel</a></p>
<ul>
<li><b>Add new User:</b> At the bottom right of the list with the existing users you see a drop down select box. Choose 'User' and click 'add'. You are taken to the user data form for new users. Fill out all required fields and click 'save' to create a new user account.</li><br/>
<li><b>Delete a User:</b> To delete a user mark the checkbox next to that user and click the 'delete' button.</li><br/>
<li><b>Change role assignment:</b> Each user account must be assigned to at least one role, the default role. This is done in the 'edit properties' panel of the user. If you want to assign the user to more than one role click on the tab 'Role Assignment' Here you can review all roles the user is currently assigned to and add/drop the user from a role. (todo: role assignment tab doesn't exist yet. The list 'active roles' is located in edit properties).</li><br/>
<li><b>Edit User profile:</b> Click on the icon next to the user's name to open the user data form. Here you may alter the data. At the bottom is an option 'send email to inform user about changes'. This could be important if you change the password or login name. Note that this option only works if the mail server is properly configured (see <a href="#12">Mail Settings</a>).</li><br/>
</ul>


<a name="16">&nbsp;<br/><h2>Object Management</h2></a>
<p>The term object management refers not to a specific panel but to the basic administrative task like creating, deleting, copying and moving objects within your object hierarchy. Most objects can be manipulated this way, except special folder objects like the system settings folder or role folders.
In the object list below you see different buttons that provide you the basic managing options: Cut, copy, link, paste, delete.
</p>
<p>
Working with this tools is done in a manner similar to any file explorer you might used to from your PC.
</p>

<p>
Adding an new object:
To the bottom right of your object list you see a dropdown men&uuml;, where you choose the desired object you want to create in the object currently viewing.
Depending on the object's containment rules defined in <a href="#objects_xml">objects.xml</a> the list of the offered subobjects may differ.
When you have selected an object you are taken to the edit properties panel that you are already familiar with. Click 'save' when finished to register the new object to the system.</p>

<p>Moving an object</p>
<p>
Select the objects in the list you want to cut by checking the approbiate checkboxes and click on 'cut'. You will still see the object(s) in the list but they are now crossed out. Furthermore a new button appeared in in the button bar saying 'paste'.
Now browse to the location where you want to move the prior selected object(s). Once arrived click on 'paste' to 'drop' your object(s) in place.
</p>

<p>marking</p>
<p>Whenever you select one of the actions cut, copy or link, the selected objects are only marked, the intended action is not performed until you click on 'paste'.
What actually happens is that the system only 'remembers' the selected objects and the considered action in the session. Once you have clicked on 'paste' the system conducts your action.</p>

<p>access control</p>
<p>Please note that all involved access control issues of your transactions are checked automatically.
For example you may not copy or move an object to a place where you have no create permission for that object.
Or you may not move an object although you are permitted to add the object in the new location because you have no right to delete it in the old place (what actually will happen when moving objects).

</p>
<p><b>Linking and copying objects</b></p>
<p>Both actions create a new reference on the selected object, object_data entry. The difference between both actions is that linked objects are only referenced</p>

<p>Linking an object creates a new reference_id for the selected object(s). This reference_id  points to the same object with all its data. Thus it doesn't matter from which reference the object is accessed, you work with the same data set. All references pointing to the same object are treated virtual equal in the system. There is no distinction between the 'original' reference and the 'second', 'third', … Therefore you cannot distinguish between objects in the object hierarchy if they were original created or later linked in that place.
When you delete an object the system checks if this would be the last reference of it in the hierarchy and deletes the corresponding data tables too. If there is another reference on this object in the tree, only the reference_id of the selected object is removed.</p>
<p>The managing functions (cut, copy, paste, delete and link) all working recursive. This means that the chosen action is performed with your selected object and all objects under it!</p>
<p>Therefore be careful with the copy function! Because this function copies the whole subtree under the selected object you may overload your server if you have a deep object hierarchy with many levels and have selected an object for copying at the top of the tree.
Linking object subtree is no problem because the system only creates new references Ids and insert them into the tree table. Therefore use the copy function with care and limit it to copy single objects or small subtrees. Consider a group containing 5 learning modules, 2 forum and dozen of shared documents. Depending of the size of the course and the files, copying just this small subset of objects could a quite reasonable impact on your server and the database.</p>


<a name="scenario1">&nbsp;<br/><h2>Example scenario</h2></a>
<p>The role default setup you will find when installing ILIAS3 the first time reflects the permission model used in ILIAS2.x. The basic system groups 'Administrator', 'Author', 'Learner' and 'Guest' are now referred as system roles. That means that their permission settings basically apply for each newly created object in the system. Users with the role 'Learner' may see all resources and have read access to them, 'Authors' may create new learning modules and edit existing ones and 'Administrators' have access to the Administration console.</p>
<p>Depending on your organizational structure and your projected use of ILIAS3 it might be that you don't need these basic roles at all. Because of the hierarchical concept of the access control system each user must assigned at least one system role in order to access the root node of the system. That means you may setup only one system role called 'ILIAS user' where all permissions are disabled except for the root object (visible and read). Furthermore you need at least an 'Administrator' role that grant you access to everything in order to let you administrate the system.</p>

<p><b>Consider the following scenario:</b><br/>
A small company offers courses and seminars about the use of standard application software like word processing and working with spreadsheets. The company wants to setup virtual class rooms for the attendants where all resources related to the course are gathered. This could be learning modules for the lessons, additional documents and exercises and collaborative tools for the course members only like a forum or email. </p>
<p><b>Our role model should satisfy these conditions:</b>
<ul>
<li>Class attendants shall only see the class rooms they actually attend to.</li>
<li>Furthermore the users should be allowed to exchange documents with their classmates.</li>
<li>In addition the company wants to retain visible access for past courses to those persons that once completed a course in the past and give them read access to the courses they had subscribed to.</li>
<li>And finally we want that all currently running courses should be visible to the public and all non-attendants, respectively, to advertise new costumers.</li>
</ul>
</p>

<p><b>With these assumptions taken above we can identify the following roles:</b>
<ul>
<li>ILIAS user (system role)</li>
<li>Class attendant (for each group/class room)</li>
<li>Guest (for all the rest that never participated or is participating in a class, system role)</li>
<li>Archive (not actual an assignable role but a role template, see below)</li>
</ul>
</p>
<p><b>Setting up the role model and object structure</b></p>
<p>First we create the system role 'ILIAS user' in the main role folder. In the role's permission template we enable only the <span class="ops">visible</span> and <span class="ops">read</span> permission for categories beside the root object which requires to be visible and readable too (see above).</p>
<p>How we handle the described 'guest' access? We want to 'tease' new users and encourage them to become our customer by showing to them all currently available seminars. But they only shall see the running courses not those in the archive. The transcription of the described conditions leads to the conclusion that we need to define another system role 'guest'. We only permit the 'visible' permission for categories and groups to the 'guest' role (and for the root object of course).</p>
<p>Now we create two category objects. The first is labelled 'current classes' containing the classes recently running, and the other category 'past classes' to hold classes that are already over. The permission settings for these objects are set up almost correctly due to our predefined settings for the roles 'ILIAS user' and 'guest'. Why almost? Well, we decided that 'guest' only shall peer into the currently running courses not into the archive. Therefore we need to <a href="#stopping_inheritance">stop the inheritance of permission settings</a> for the 'past courses' category: Select the category and click on the permission tab. In the permission matrix find the column for the 'guest' role and check the box to the bottom saying 'stop inheritance'. Now switch into the newly created role folder and select the local role 'guest'. Here we revoke ALL permissions and activate the option <a href="#change_exisiting_objects">change existing objects</a> (to accommodate the category itself). 'Guest' users now will weather see the 'past courses' category nor be able to access any classes in it.</p>
<p>Now we are ready to set up the 'class rooms' for the seminars. For each class room a new group object is created in the 'current classes' category. For every group we need to define a local role 'class attendant'. Fortunately two local roles are created by default in each group object: A 'member' role and an 'administrator' role. The 'member' role fits well for our intended 'class attendant' role.</p>
<p><b>We only have to accommodate the permission template settings for that role by enable the following permissions:</b><br/>
<ul>
<li>Group: <span class="ops">visible</span>, <span class="ops">read</span></li>
<li>Learning module: <span class="ops">visible</span>, <span class="ops">read</span></li>
<li>Course: <span class="ops">visible</span>, <span class="ops">read</span></li>
<li>Forum: <span class="ops">visible</span>, <span class="ops">read</span>, <span class="ops">write</span> (maybe <span class="ops">create</span> to allow users to add new forums)</li>
<li>File: <span class="ops">visible</span>, <span class="ops">read</span>, <span class="ops">create</span> (we want to allow the users to upload files)</li>
</ul>
</p>
<p><b>The Role template 'Archive'</b></p>
<p>In this scenario we demanded that after a course is over it should be still accessible by the users formerly attended to it. Since the course has ended the last state should be 'frozen', thus revoking any write access to the resources. This task can be performed by manually revoking all <span class="ops">write</span> and <span class="ops">create</span> permissions in the role settings once a course is moved to the archive. Or we prepare a <a href="#role_templates">Role Template</a> that consist of similar settings above but not the permissions <span class="ops">write</span> and <span class="ops">create</span> for any object type. With this Role Template at hand we can do this easily by <a href="#adopt_permissions">adopting it's permission settings</a> to the member role of the course when we put the group in the archive.</p>

<p><b>Common use cases and how to conduct them</b></p>
<p>This is basic framework that fulfils the conditions of the scenario described here. Now you are ready to add your learning modules, forums and documents to each group ('class room') and of course assign users to them.</p>
<ol>
<li>Assign a user to a class room:
<br/>Switch to the regarded group an select the option add new member (not implemented yet). Alternatively switch to the user administration panel, select the user and click an the tab 'Role assignment'. Here you see a list of the existing roles and those one active for the user you are currently reviewing. Pick the member role of the regarded group and assign it to the user (Panel 'role assignmemt' is not implemented yet. Currently this functionality is located in the Role administration panel).</li>
<li>Deassign a user from a class room:
<br/>Switch into the group view and click the 'Group members' tab. Here you may unsubscribe the user by clicking on the arrow icon next to the user's entry row.</li>
<li>You have a document or learning module in a class room that shall be accessible to another class room:
<br/>Switch into the group view and check the box of the object in question. Click <i>link</i>, switch to your target group an select 'paste'. The correct permission settings is accommodated automatically by the system.</li>
<li>You want to use a learning module in another class room but you have to modify the content a bit in order to suit with the theme of the target group.
<br/>Proceed like in 3. but instead <i>link</i> you click on <i>copy</i>. The content of the entire learning module is copied, thus retaining the original source from being changed when you modify the learning module in the target group.</li>
<li>Your seminar is over and you want to move the class room to the 'past courses' folder:
<br/>This works similar to the procedure described in 3. and 4.: Select the 'current courses' folder and check the box for the whole group you want to move. Now select <i>cut</i>, switch to the 'past courses' folder and <i>paste</i> the group into it.</li>
<li>You want to grant read only access to the archive for the course attendants after the course is over and you moved the course into the archive:
<br/>Here comes the previously created role template 'archive' into play: Because the course is closed, the last state when the course ended should be preserved. Switch to the role administration panel and select the member ('class attendant') role for the course. Scroll down and adopt the permission settings from the pre-defined 'archive' role template. (To do: needs an additional checkbox to accommodate 'existing objects' according to the new settings).</li>
<li>Assign all users of the course to the 'archive' role.
<br/>However, you have to do this manually because an appropriate function to perform group wise role assignments is not implemented yet.</li>
</ol>

<p><b>A remark on the 'guest' role</b></p>
<p>The idea behind the guest role is to handle all unregistered users. In other words: A role for users passing along the website. This assumes that you are able to access ILIAS3 without having an account what is not possible yet but will be implemented in the initial beta release.</p>
<p>Of course the translation of the assumed conditions in this scenario may be achieved with another role model too. For example the 'guest' functionality could be also realized by setting up a third category called 'public' where you <i>link</i> in the course that should be visible to guests. Then you do not model the 'guest' role as system role but as a local role within the 'public' folder and stop the inheritance for the 'ILIAS user' role. The advantage of this approach is, that not all resources in the 'current courses' are visible to the public but only those you explicitly link into the 'public' folder.</p>
<p><b>Modelling tips</b></p>
<p>The conditions I presumed in this scenario were chosen with the intention to scope all features of the RBAC system and demonstrate their usage by common use cases you might encounter when working with ILIAS3. You should now understand the main purpose of the <a href="#16"><i>cut</i>,<i>copy</i>,<i>link</i> & <i>paste</i> functionality</a>, of <a href="#06">Local Roles</a> and <a href="#role_templates">Role Templates</a>, and how to use the options <a href="#stopping_inheritance">stop inheritance</a> and <a href="#change_existing_objects">change existing objects</a>.</p>
<p>The key point is to analyze your organizational structure BEFORE you start modelling your roles. Identify roles and responsibilities of all involved persons and think about the workflow of common tasks you want to implement later in the system. Choosing the wrong model could end up in a very complicated permission administration.</p>
<p>A good rule of thumb to follow when designing a role model is to identify the 'least common denominator' for the permissions that should be granted to users by one role and put this definition on the top of your structure (<a href="#05">System Roles</a>). Grant more specialized permissions to users with local roles deeper in the hierarchy. For example if the role 'ILIAS user' in the scenario presented above would grant <span class="ops">visible</span> or even <span class="ops">read</span> access to all group objects you would end up in <a href="#stopping_inheritance">stopping the inheritance</a> for each new group created resulting in many local roles I have to consider when managing my resources only to prevent the access for everyone.</p>
<p>Instead of <a href="#stopping_inheritance">stopping the inheritance</a> for each role you may also change only the object permission. But remember when ever you choose the option <a href="#change_exisiting_objects">change existing objects</a> in a role's permission template where the object's permissions derived from, the permissions will be set back to the permission settings according to the permission rules defined in the <a href="#04">Role Permission Template</a>.</p>


<a name="17">&nbsp;<br/><h2>Information for developers</h2></a>


<a name="18">&nbsp;<br/><h2>Class structure</h2></a>
<p>The RBAC core system consists of the following classes:</p>
<ul>
<li>class.ilRbacAdmin.php</li>
<li>class.ilRbacAdminH.php</li>
<li>class.ilRbacReview.php</li>
<li>class.ilRbacReviewH.php</li>
<li>class.ilRbacSystem.php</li>
<li>class.ilRbacSystemH.php</li>
</ul><br/>
<p>According to the RBAC Functional specification from NIST the functions are divided up in administrative, system and review functions. The class name tells you where it belongs to.</p>
<ul>
<li><b>Administrative functions</b> specify administrative operations for the creation and maintenance of RBAC element sets and relations.</li><br/>
<li><b>Review functions</b> are for performing administrative queries.</li><br/>
<li><b>System functions</b> are for creating and managing RBAC attributes on user sessions and making access control decisions</li><br/>
</ul>
<p>The class files marked with an 'H' at the end of their name are empty yet. They should contain functions belonging to the second level of RBAC with Role Hierarchies. The feature may be implemented in future.</p>


<a name="19">&nbsp;<br/><h2>Database model</h2></a>
<p>The following picture describes the database structure and the tables involved to RBAC system.</p>

<p>
<b>Database model and table relations of the RBAC system</b><br/>
<img src="./images/rbac_core_dbschema.gif" /></p>

<ul>
<li><b>object_data:</b> Contains basic data for each object in ILIAS3.</li><br/>
<li><b>object_reference:</b> All RBAC protected object are not addressed by their object_id but with a reference_id (see <a href="#identifier">Unique Identifier</a>). Only the object's reference_id is stored in the tree table. An object may have more than 1 reference_id This allows to allocate the same object multiple times in the object hierarchy and apply individual permission settings.</li><br/>
<li><b>tree:</b> Contains the object hierarchy. The RBAC system uses this structure information for <a href="#07">permission inheritance</a> and to determine the scope of <a href="#06">Local Roles</a>. Furthermore the tree helps to store less data for the permission information for the same object.</li><br/>
<li><b>rbac_operations:</b> Contains all operations. If you need a specific operation that doesn't exists yet, you have to add it here.</li><br/>
<li><b>rbac_templates:</b> Contains the data for the <a href="#04">Role Permission Templates</a>.</li><br/>
<li><b>rbac_ta:</b> (Type assignment) Contains the operation-object type relations. Each object type has specific sets of operations.</li><br/>
<li><b>rbac_pa:</b> (Permission assignment). This table contains the most important information: Here are the relations between a role, the object and the permission settings stored. For each specific object exists a data base entry, which role may exercise which operation on this object. In order to keep the data set small, the operations are serialized, put down thus as string.</li><br/>
<li><b>rbac_ua:</b> (User assignment) Contains the user-role relations.</li><br/>
<li><b>rbac_fa:</b> (Folder assignment) This table holds the information in which role folder a role is located. Because roles (and users) have no permission entries, the permissions of these objects are administrated by a container object 'Role Folder' (resp. 'User Folder') in which they are stored. This table is important for the <a href="#06">Local Role concept</a>. 'Linked' Local Roles are flagged 'unassignable'.</li><br/>
</ul>

<p>A specific operation (<span class="ops">visible</span>, <span class="ops">read</span>, <span class="ops">write</span> ...) is assigned to each object (Category, Learning Module, Forum …). For each specific object exists a data base entry, which role may exercise which operation on this object. In order to keep the data set small, the operations are serialized, put down thus as string, in the table rbac_pa (Rbac by permission assignment). For roles and users there are no permission entries. The permissions of these object are administrated by the containers (Role Folder ,User Folder) in which they are stored.
The tree table contains the information about the object hierarchy. All RBAC protected objects are stored here.</p>


<a name="add_modules">&nbsp;<br/><h2>Adding new Modules to ILIAS3</h2></a>
<ul>
<li>add object type definition</li>
<li>define & add new operations (if required)</li>
<li>create object classes</li>
</ul>


<a name="add_object_type">&nbsp;<h3>Adding a new object type</h3></a>
<b>Step 1</b>
<p>Find an abbreviation for your object type with at least 2 and no more than 5 or 6 characters. This abbreviation is used in the whole system to identify your object type. Examples are <span class="typ">frm</span> for the ForumObject, <span class="typ">grp</span> for the GroupObject.</p>
<b>Step 2</b>
<p>Create the object type definition. This is done in <a href="#objects_xml">objects.xml</a></p>
<b>Step 3</b>
<p>You have to register your new object type in the system by adding the following data to the object_data table:</p>
<pre class="sql">
INSERT INTO object_data (type, title, description, owner, create_date, last_update)
VALUES ('typ', '&lt;your abbreviation&gt;', '&lt;full name of your object type&gt;', -1, now(), now());
</pre>
<b>Step 4</b>
<p>Log into ILIAS3 and go to the <a href="#13">Object Type Management Panel</a> in the Adminstration Console. Find in the Object type definiton list your previously created object type defintion and click on it. Click the tab <i>Edit Operations</i> to enable the operations you want to allow to be performable on your object type. Some operations are mandatory and should be assign typ every object type like <span class="ops">create</span>, <span class="ops">visible</span> or <span class="ops">read</span>.</p>
<p>If you find out that non of the available operations suit for a special task you have intended for your object type you need to define additional operations (see <a href="#add_operations">Defining & adding new operations</a>).</p>
<b>Step 5</b>
<p>Now switch to the <a href="#14">Role Management Panel</a> and accommodate the access control of the roles for your new object type.</p>


<a name="add_operations">&nbsp;<h3>Defining & adding new operations</h3></a>
<p>New operations needs to added manually to the database with the following SQL statement</p>
<pre class="sql">
INSERT INTO rbac_operations (operation, description)
VALUES ('&lt;your operation&gt;', '&lt;short description what the operation does&gt;');
</pre>
<p>The operation in now registered to the system and can by assign to any object type interactively via the <a href="#13">Object Administration Panel</a>.</p>


<a name="setup_classes">&nbsp;<h3>Setting up the basic object classes</h3></a>
<p>Your basic object classes must be derived from <code>class.ilObject.php</code> and <code>class.ilObjectGUI.php</code> to
ensure the correct integration of your new module into the ILIAS system.
To keep the integration easy the system looks automatically for your derived object classes
by using the name you defined by the attribute '<i>class_name</i>' in <a href="#objects_xml_doc">objects.xml</a> as a part of the file name:
<br/><code>class.ilObj&lt;class_name&gt;.php</code> and <code>class.ilObj&lt;class_name&gt;GUI.php</code>.</p>
<p>In the classes directory of the ILIAS3 distribution you will find two template classes (those with the prefix 'template') providing a basic setup. Copy theses templates and rename them to the appropriate file names.</p>
<p>Then you have to accommodate the code according your definitions made in objects.xml (see pictures below):
<ul>
<li>module_name: This is the name of the class defined by <i>class_name</i></li>
<li>type ID: The Identifier you defined in objects.xml</li>
</ul></p>
<p><img src="./images/class_obj_tpl.gif" border="1"/><br/>Code snippet of class template for your Object class.</p>
<p><img src="./images/class_objGUI_tpl.gif" border="1"/><br/>Code snippet of class template for your ObjectGUI class</p>
<p>As you can see both constructors are very similar. The last thing you have to concern about is to decide wether object type is called by a reference ID or its object ID. The common way is to refer an object by a reference ID (That's the default setting).
If the derived objects from your new module should be protected by the RBAC system, the object's location in the object hierarchy needs to be stored in the tree table, and therefore have to be called by a reference ID only.
(More on this topic can be found in the chapters about <a href="#identifiers">Unique Identifiers</a> and <a href="#todo">todo</a>.</p>
<p> With this basic classes setup you are able to create new instances of your new object type and they have all the basic functionalities already implemented. Now you can start to populate the classes with your own functions.</p>
<a name="objects_xml">&nbsp;<h3>Object type definition concept</h3></a>
<p>The file <code>objects.xml</code> contains important basic definitions for each object type in ILIAS3. Here you define an <a href="#identifier_types">unique identifier</a> which is used in all application levels of ILIAS3 and specify the hierarchical relations between this object type and other object types. In addition, you define also the main interface options - <a href="#property_tabs">property tabs</a> and <a href="#action_buttons">action buttons</a> - that should be displayed to the user in the interface.</p>
<p>All type definitions in objects.xml are read on every mouse click in ILIAS3 into the variable <code class="var">$ObjDefinition</code>.
<br/><code class="var">$ObjDefiniton</code> is an object instance of the class <code>class.ilObjectDefinition.php</code> and provides all methods you need to access and work with the object type data (for detailed a description of each method please consult the ILIAS3-API documentation for that class).</p>
<p>Below you see the object type definition for the LearningModule object as an example. right after the example you find a documentation that explains the meaning of each element and what are the effect of their attributes.</p>
<p><img src="./images/objects_xml1.gif" border="1"/><br/>Example XML for an object type definition of 'LearningModule'</p>


<p><a name="objects_xml_doc">&nbsp;<b>object.xml documentation</b></a><br/>
<table width="100%" border="1">
<tr valign="top">
<td width="15%" colspan="3"><b>&lt;object&gt;</b></td>
</tr>
<tr>
<td>Description</td>
<td width="80%" colspan="2">This is the root element of an object type definition containing all information about the object type</td>
</tr>
<tr valign="top">
<td>Subelements</td>
<td width="30%" colspan="2">&lt;subobj&gt; <i>(required)</i>, &lt;property&gt;, &lt;action&gt;</td>
</tr>
<tr valign="top">
<td rowspan="4">Attributes</td>
<td>name <i>(required)</i></td>
<td>
The abbreviation you chose is used in the whole system to identify your object type:
<ul>
<li>In code object types are addressed by this Identifier.</li>
<li>Additional database tables that are required to store the object type specific data should have the Identifier as prefix in the table name (i.e. <code>frm_posts</code> for post data of the forum object).</li>
<li>Furthermore the Identifier is used in by the template engine to automatically load a appropiate standard template (see <a href="#templates">Using templates)</a>.</li>
</ul>
Your Identifier should have at least 2 and no more than 5 or 6 characters. The data is stored in the object_data table where the title column contains the abbreviation and the type column '<i>typ</i>'.
</td>
</tr>
<tr valign="top">
<td>class_name <i>(required)</i></td>
<td>All object classes must be derived from <code>class.ilObject.php</code> and <code>class.ilObjectGUI.php</code> to
ensure the correct integration of the object type into the ILIAS system.
To keep the integration easy the system looks automatically for your derived object classes
by using <i>class_name</i> as a part of the file name:
<br/><code>class.ilObj&lt;class_name&gt;.php</code> and <code>class.ilObj&lt;class_name&gt;GUI.php</code>.
<br/>Both classes are derived from <code>class.ilObject.php</code> and <code>class.ilObjectGUI.php</code> respectively and inherit the required basic funtionality from them.
(see <a href="#objects">Object concept</a> for more information and example class templates to use for new object classes).
</td>
</tr>
<tr valign="top">
<td>checkbox<br/><i>(required in administration panel only)</i></td>
<td>Toggles the visibility of the checkbox in the Administration Console. When the user is not allowed to perform any actions with that object (i.e. <i>copy</i>, <i>paste</i>, <i>delete</i>) the value is set to '0', otherwise '1' </td>
</tr>
<tr valign="top">
<td>inherit<br/><i>(required in administration panel only)</i></td>
<td>This flag determines if it is allowed to stop permission inheritance for this object type (set to '1').
<br/>Some RBAC protected object are specific container objects that does not allow to contain a local role folder. Examples are the System Folder object (<i>adm</i>) and User Folder object (<i>usrf</i>).</td>
</tr>
<tr valign="top">
<td colspan="3"><b>&lt;subobj&gt;</b></td>
</tr>
<tr valign="top">
<td>Description</td>
<td colspan="2">Here you define which other object types this object may contain.</td>
</tr>
<tr valign="top">
<td>Subelements</td>
<td colspan="2"><i>none</i></td>
</tr>
<tr valign="top">
<td rowspan="2">Attributes</td>
<td>name <i>(required)</i></td>
<td>Put here the Identifier of the object type you want to allow to within this object.
<br/>Rules:
<ul>
<li>You may add any other object type defined in objects.xml,</li>
<li>You may add as many object types as you like,</li>
<li>You may add the current object type itself,</li>
<li>You may NOT add an object type that leads to a recursive loop due to the possible subobjects defined in the object type you want to add.
<br/>Example: A Category object (<i>cat</i>) may contain a Group object (<i>grp</i>) but then a Group object is not allowed to contain Category objects because both containment rules overlap each other which cause an infinite loop in the RBAC system.</li>
</ul>
</td>
</tr>
<tr valign="top">
<td>max</td>
<td>Determines the maximum number of objects that are allowed to exist of an object type in this object. Some RBAC protected objects with specific purposes like the System Settings Folder object or the Role Folder object may only appear once within another object (max=1)</td>
</tr>
<tr valign="top">
<td colspan="3"><b>&lt;property&gt;</b></td>
</tr>
<tr valign="top">
<td>Description</td>
<td colspan="2">Here you may define different property panels. These panels are displayed in the user interface as 'tabs'. The text you have written between the tag is interpreted as the tab's label. The system treats the label text as a language keyword and automatically attempts to translate the tab label by looking in the language data for an entry with this value.</td>
</tr>
<tr valign="top">
<td>Subelements</td>
<td colspan="2"><i>none</i></td>
</tr>
<tr valign="top">
<td rowspan="2">Attributes</td>
<td>name <i>(required)</i></td>
<td>Here you define the command keyword which triggers the property tab in the code. When you click on a tab the global interface control variable <code class="var">$cmd</code> is loaded with that value and send to the server.
You may now process the <code class="var">$cmd</code> variable in your object class and determine what should happen when the command was sent.
Please note that all commands in the administration console trigger appropriate functions named in the way <code>&lt;<span class="var">$cmd</span>&gt;Object</code>. (i.e. If the value of <code class="var">$cmd</code> is 'read' a fuction named '<code>readObject</code>' is called automatically). This convention only applies to the administration interface.
</td>
</tr>
<tr valign="top">
<td>module</td>
<td>Determines if the property tab should appear in the administration console (no module attribute) or in the interface of your module itself (set to '1'). </td>
</tr>
<tr valign="top">
<td colspan="3"><b>&lt;action&gt;</b></td>
</tr>
<tr valign="top">
<td>Description</td>
<td colspan="2">Here you may define different actions which are displayed by submit buttons in the interface. The functionality is similiar to the concept of property panels described above. The name attribute defines the keyword value of $cmd which is send to the server and triggers your code block. The text within the tag labels the button and passes the same translation process.
The only difference is that if an action is performed a list of object (or reference) IDs is submitted to the server to tell the system for which objects the action should be executed.</td>
</tr>
<tr valign="top">
<td>Subelements</td>
<td colspan="2"><i>none</i></td>
</tr>
<tr valign="top">
<td>Attributes</td>
<td>name <i>(required)</i></td>
<td>Defines the command keyword (see name attribute of property element above)</td>
</tr>
</table></p>


<a name="sessions">&nbsp;<br/><h2>Active Roles & Sessions</h2></a>
<p>The set of active roles of user are only read once from the database when the user logs in. All roles are stored in the session data of that user.</p>
<p>Special case: When an already logged in user is assigned to a new role he has do log out and log in again in order to update his set of active roles. Please keep this in mind whenever you update the role list of a user.</p>
<p>To do: Move Sessionmanagement to database and use an additional column with the user_id. When this feature is implemented, the described problem can be easily solved.</p>


<a name="identifier">&nbsp;<br/><h2>Unique Identifier</h2></a>
<p>ILIAS3 knows three different ways to identify unambiguous every object and every object type. To use three different concepts might sound confusing but it isn't. Each concept serves a different purpose and is used for another task in the system.</p>

<a name="identifier_types">&nbsp;<br/><h3>Type ID (for object types)</h3></a>
<p>All objects have a small 'signature' that tells you of what type the object is. This signature is a short abbreviation defined in objects.xml and consists of at least 2 letters.</p>
<p>The type ID is used in ILIAS3 in several ways: First you are always able to determine an object's type as this information is part of the basic data in the object registry (object_data table).
Thereby decision making in code is possible depending upon the object's type. You may also use the type ID to filter particular object types or generate lists of objects of one type.
In the API are already some functions included that offers type-based operations like <code>ilUtil::getObjectsByOperations()</code>.</p>
<p>Furthermore the type ID acts as a recommendation how to label database tables and HTML templates.
All properties that are associated to a specific object type should be marked with the appropiate type ID. This allows other developers to track down object type related parts of ILIAS3 throughout the application layers:</p>
<ul>
<li>object type specific database tables should have type ID as prefix in their name: <code>&lt;typeID&gt;_tablename</code>.</li>
<li>object type specific HTML-templates are named in the way <code>tpl.&lt;typeID&gt;_&lt;purposeOfTemplate&gt;.html</code> (i.e. if you need a template that is used for displaying basic information about a course, you want to name your template like <code>tpl.crs_overview.html</code>).</li>
</ul>
<p>In code the variable's name containing the type ID is <span class="var">$type</span>.
<br/>If passed via the URI: <span class="var">$_GET["type"]</span>.
<br/>Type ID is a member variable of <code>class.ilObject.php</code> and is accessed with the function <code>$obj->getType()</code>.</p>

<a name="identifier_objects">&nbsp;<br/><h3>object ID (for object instances)</h3></a>
<p>Every time when you create a new object, this object is registered in the system with a few basic information (object type, object title & description, create date and who created it).
In the registering process a numeric ID is generated and assigned to that object. This Identifier is referred as <b><i>object ID</i></b> and is unique in the entire system. No object ID is assigned twice to different objects.</p>
<p>In code the variable's name containing the object ID is <span class="var">$obj_id</span>.
<br/>If passed via the URI: <span class="var">$_GET["obj_id"]</span>.
<br/>Object ID is a member variable of <code>class.ilObject.php</code> and is accessed with the function <code>$obj->getId()</code>.</p>

<a name="identifier_objects">&nbsp;<br/><h3>reference ID (for object instances)</h3></a>
<p>In addition to the object ID generated during the registering process of an object, for all RBAC protected objects another Identifier called <b><i>reference ID</i></b> is generated.
Each object has always exactly one object ID but may have multiple reference IDs. Each reference ID is unique like the object ID.
Thus you may have an object ID '15' and a reference ID '15' but they don't must identify the same object!</p>
<ul>
<li>An object ID refers directly to the corresponding data entry in the object_data table, that - depending on the object's type - 'knows' the additional db tables holding the remaining data that are belonging to the object.</li>
<li>Reference IDs are stored in the object_reference table and only point to an object ID.</li>
</ul>
<p>If you are experienced in programming (and I guess you are if you're reading this part of the manual) you might be familiar with such a referencing concept.</p>
<p>Reference IDs were introduced in ILIAS3 only for one purpose to allow one and the same object to be allocated multiple times in the object hierarchy. Putting an object into the hierarchy several times in different locations is a useful feature when managing your access control rules (see <a href="#scenario1">Example scenario</a>).</p>
<p>In code the variable's name containing the reference ID is <span class="var">$ref_id</span>.
<br/>If passed via the URI: <span class="var">$_GET["ref_id"]</span>.
<br/>Reference ID is a member variable of <code>class.ilObject.php</code> and is accessed with the function <code>$obj->getRefId()</code>.</p>

<a name="objects">&nbsp;<br/><h2>Object Concept</h2></a>
<p>general description of the system architecture</p>
<p>to do</p>

<p>Database layer: How objects and their data are stored in the database
</p>
<p>
Application layer:
</p>
<p>
Presentation layer (GUI):
</p>


<a name="object_types">&nbsp;<br/><h2>Object type documentation</h2></a>

<p>detailed description of each object type, their intended purposes and remarks about the usage of special folder objects</p>
<p>please place object type related descriptions here!</p>


<a name="root"><h3>&nbsp;Root Folder object</h3></a>


<a name="adm"><h3>&nbsp;System Folder object</h3></a>


<a name="lngf"><h3>&nbsp;Language Folder object</h3></a>


<a name="lng"><h3>&nbsp;Language object</h3></a>


<a name="mail"><h3>&nbsp;Mail settings object</h3></a>


<a name="rolf"><h3>&nbsp;Role Folder object</h3></a>
<p>The <span class="ops">create</span> operation is only used and checked if you create a new role folder manually.</p>
<p><span class="ops">create</span> is NOT checked when
<ul>
<li>you add an object for which a local role is created by default. A role folder under the new object to place the default local role is created automatically. (Example object types are Group, Forum or Learning Module);</li>
<li>you stop the inheritance of permission settings for a role. A linked local role is created and placed into an also auto-created  local role folder.</li>
</ul>
</p>
<p>In this cases the <span class="ops">create</span> - operation is not checked because the permission is not granted by the role folder itself but by the object which actually was created. The system only checks if the user is permitted to create the Forum, Group, etc. correlated with the local role folder. The role folder object is part of the 'creation process' of that object. As with stopping inheritance where role folder creation is part of the 'stopping inheritance' process.</p>
<p>In both cases a rolefolder is created by the system automatically. Taking into account that these cases are the most common cases you don't need to grant the 'create' operation for role folders for most of the users .</p>


<a name="role"><h3>&nbsp;Role object</h3></a>


<a name="rolt"><h3>&nbsp;Role Template object</h3></a>


<a name="usrf"><h3>&nbsp;User Folder object</h3></a>


<a name="usr"><h3>&nbsp;User object</h3></a>


<a name="objf"><h3>&nbsp;Object Folder object</h3></a>


<a name="typ"><h3>&nbsp;Object Type object</h3></a>


<a name="cat"><h3>&nbsp;Category object</h3></a>


<a name="grp"><h3>&nbsp;Group object</h3></a>


<a name="frm"><h3>&nbsp;Forum object</h3></a>


<a name="file"><h3>&nbsp;File object</h3></a>


<a name="crs"><h3>&nbsp;Course object</h3></a>


<a name="lm"><h3>&nbsp;LearningModule object</h3></a>


<a name="slm"><h3>&nbsp;SCORM LearningModule object</h3></a>


<a name="templates">&nbsp;<br/><h2>Using templates</h2></a>

<p>to do</p>
<p><img src="./images/tpl_structure.gif" border="1"/><br/>Template structure of ILIAS default skin: basic structure</p>
<p><img src="./images/tpl_flow.gif" border="1"/><br/>Relation between php scripts and templates of ILIAS default skin: (Example: admin console)</p>


<a name="errorhandling">&nbsp;<br/><h2>Error handling</h2></a>


<a name="feedback">&nbsp;<br/><h2>System feedback</h2></a>


<a name="sendmessage">&nbsp;<br/><h3>sendMessage()</h3></a>


<a name="infopanel">&nbsp;<br/><h3>Infopanel</h3></a>


<a name="db_updates">&nbsp;<br/><h2>Database updates & migration</h2></a>


<a name="appendix">&nbsp;<br/><h2>Appendix</h2></a>


<a name="glossary">&nbsp;<br/><h2>Glossary</h2></a>

<p>to do</p>
<a name="links">&nbsp;<br/><h2>Resources</h2></a>

<p>to do</p>
<a href="http://csrc.nist.gov/rbac/rbac-std-ncits.pdf">download proposed standard (pdf)</a>


</body>
</html>