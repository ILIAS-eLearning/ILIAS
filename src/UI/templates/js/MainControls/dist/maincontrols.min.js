/**
 * This file is part of ILIAS, a powerful learning management system
 * published by ILIAS open source e-Learning e.V.
 *
 * ILIAS is licensed with the GPL-3.0,
 * see https://www.gnu.org/licenses/gpl-3.0.en.html
 * You should have received a copy of said license along with the
 * source code, too.
 *
 * If this is not the case or you just want to try ILIAS, you'll find
 * us at:
 * https://www.ilias.de
 * https://github.com/ILIAS-eLearning
 */
!function(t,e){"use strict";function s(t){return t&&"object"==typeof t&&"default"in t?t:{default:t}}var i=s(t),a=s(e);class n{#t;#e;#s="engaged";#i="il-maincontrols-metabar";#a="il-metabar-slates";#n="il-metabar-more-button";#l="il-metabar-more-slate";#r="il-maincontrols-slate";#o="engaged";#g;constructor(t,e){this.#t=t,this.#e=e}registerSignals(t,e){this.#t(document).on(t,((t,e)=>(this.#h(t,e),il.UI.page.isSmallScreen()&&il.UI.maincontrols.mainbar&&il.UI.maincontrols.mainbar.disengageAll(),!1))),this.#t(document).on(e,(()=>(this.onClickDisengageAll(),!1))),this.#t(`.${this.#i}`).on("click",(()=>{this.#g=!0})),this.#t("body").on("click",(()=>{this.#g?this.#g=!1:this.onClickDisengageAll()})),this.#t(`.${this.#a} > .${this.#r}`).on("focusout",(t=>{if(!il.UI.page.isSmallScreen()){const e=t.relatedTarget,s=t.currentTarget;this.#t.contains(s,e)||this.onClickDisengageAll()}}))}#h(t,e){const s=e.triggerer;this.#c(s)?this.#d(s):(this.disengageAllSlates(),this.disengageAllButtons(),0===s.parents(`.${this.#l}`).length&&this.#u(s))}onClickDisengageAll(){this.disengageAllButtons(),this.disengageAllSlates()}#u(t){t.addClass(this.#s),t.attr("aria-expanded",!0)}#d(t){t.removeClass(this.#s),t.attr("aria-expanded",!1)}#c(t){return t.hasClass(this.#s)}disengageAllButtons(){this.#t(`#${this.#e}.${this.#i}`).children("li").children(`.btn.${this.#s}`).each(((t,e)=>{this.#d(this.#t(e))}))}disengageAllSlates(){this.getEngagedSlates().each(((t,e)=>{il.UI.maincontrols.slate.disengage(this.#t(e))}))}disengageAll(){this.disengageAllSlates(),this.disengageAllButtons()}getEngagedSlates(){const t=`#${this.#e} .${this.#r}.${this.#o}`;return this.#t(t)}init(){this.#S(),this.#F(),il.UI.page.isSmallScreen()?this.#E():this.#m(),this.#t(`.${this.#i}`).css("visibility","visible"),this.#t(`#${this.#e} .${this.#a}`).children(`.${this.#r}`).attr("aria-hidden",!0)}#E(){this.#p(),this.#y().hide(),this.getMoreButton().show(),this.#j()}#m(){this.getMoreButton().hide(),this.#y().show()}#S(){if(0===this.getMoreButton().length){const t=this.#t(`#${this.#e}.${this.#i}`).find(".btn, .il-link").last();this.#t(t).addClass(this.#n)}}#F(){if(0===this.#C().length){const t=this.#t(`#${this.#e} .${this.#a}`).children(`.${this.#r}`).last();this.#t(t).addClass(this.#l)}}getMoreButton(){return this.#t(`.${this.#n}`)}#C(){return this.#t(`.${this.#l}`)}#y(){return this.#t(`#${this.#e}.${this.#i}`).children("li").children(".btn, .il-link").not(`.${this.#n}`)}#p(){const t=this.#C().children(".il-maincontrols-slate-content");0===t.children().length&&this.#y().clone(!0,!0).appendTo(t)}#j(){const t=il.UI.counter.getCounterObjectOrNull(this.#C());t&&il.UI.counter.getCounterObject(this.getMoreButton()).setNoveltyTo(t.getNoveltyCount()).setStatusTo(t.getStatusCount())}}i.default.UI=i.default.UI||{},i.default.UI.maincontrols=i.default.UI.maincontrols||{},i.default.UI.maincontrols.metabar=new class{#t;#M=[];constructor(t){this.#t=t}init(t){if(void 0!==this.#M[t])throw new Error(`Metabar with id '${t}' has already been initialized.`);this.#M[t]=new n(this.#t,t)}get(t){return this.#M[t]??null}disengageAll(){Object.values(this.#M).forEach((t=>t.disengageAll()))}}(a.default),i.default.UI.maincontrols.slate=new class{#t;#$="engaged";#b="disengaged";#r="il-maincontrols-slate";#q="content";constructor(t){this.#t=t}onSignal(t,e,s,i){const a=this.#t(`#${i}`),{triggerer:n}=s,l=n.parents(".il-metabar-more-slate").length>0;if("toggle"===t)this.#B(a,n,l);else if("engage"===t)this.#f(a);else{if("replace"!==t)throw new Error(`No such SignalType: ${t}`);this.#A(i,s)}}#B(t,e,s){const i=t.closest(".il-maincontrols-metabar").attr("id"),a=il.UI.maincontrols.metabar.get(i);e.attr("id")!==a.getMoreButton().attr("id")?(this.#I(t),s||(this.#c(t)?(e.addClass(this.#$),e.removeClass(this.#b),t.trigger("in_view")):(e.removeClass(this.#$),e.addClass(this.#b)))):a.getEngagedSlates().length>0?a.disengageAllSlates():this.#I(t)}#I(t){this.#c(t)?this.disengage(t):this.#f(t)}#c(t){return t.hasClass(this.#$)}#f(t){t.removeClass(this.#b),t.addClass(this.#$),t.attr("aria-expanded","true"),t.attr("aria-hidden","false")}disengage(t){t.removeClass(this.#$),t.addClass(this.#b),t.attr("aria-expanded","false"),t.attr("aria-hidden","true")}#A(t,e){const{url:s}=e.options;il.UI.core.replaceContent(t,s,this.#q)}}(a.default)}(il,$);
